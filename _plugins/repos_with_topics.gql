# Public repos owned by the current user.
#
# Warning: This only gives the latest 100 repos by update date and does not implement paging. And
# attempting to break this out into multiple blocks for forks only and archive only gave a request timeout.

fragment Repos on RepositoryConnection {
	nodes {
		# Metadata
		name
		url
		description

		# Dates
		createdAt
		updatedAt
		pushedAt

		# Counts
		stargazers {
			totalCount
		}
		forkCount
		defaultBranchRef {
			commits: target {
				... on Commit {
					history(first: 1) {
						totalCount
					}
				}
			}
		}

		repositoryTopics(first: 10) {
			nodes {
				topic {
					name
					stargazers {
						totalCount
					}
					viewerHasStarred
				}
				url
			}
		}
	}
}

query ownedRepos {
	viewer {
		repositories(
			first: 100
			ownerAffiliations: OWNER
			privacy: PUBLIC
			orderBy: { field: UPDATED_AT, direction: DESC }
		) {
			...Repos
		}
	}
}
